{
	"dados_cat":{
		"versao":1
	},
	"atualizar_fretesaur_com_vendas":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
CREATE OR REPLACE PROCEDURE atualizar_fretesaur_com_vendas (
    p_dtini   DATE DEFAULT sysdate,
    p_dtfim   DATE DEFAULT sysdate
) AS
    
    /*
        Regra de Negocio: Analisar vinculo entre ctes e vendas aurora
        
        Este processo: preenche o campo numnotaaur,codfilialaur, dtemissaoaur criado manualmente na tabela pcconhecimentofretei se existir correspondencia
        na tabela dados_vendas_origem.
        
        Importante: Executar com dbms_output habilitado. Se o numnota preenchido na pconhecimentofretei nao corresponder ao 
        numero da nota encontrado na chavenfe sera gerado um erro e interrompido o processo para que este dado seja corrigido
        
        Autor: Antonio Alencar Velozo
        Criacao: 17/11/2020        
    */
    v_numnota   NUMBER;
    v_existe    NUMBER;
BEGIN
    FOR li IN (
        SELECT
            fi.*,
            s.codfilial,
            s.dtsaida AS dtemissaocte
        FROM
            jumbo.pcconhecimentofretei   fi
            JOIN jumbo.pcnfsaid               s ON ( s.numtransvenda = fi.numtransconhec
                                       AND s.especie = 'CO'
                                       AND s.numtransvendaorigem IS NULL )
        WHERE
            fi.numnotaaur IS NULL
            AND s.dtsaida BETWEEN p_dtini AND p_dtfim
            AND s.dtcancel IS NULL
    ) LOOP
        v_numnota := substr(li.chavenfe, 26, 9);
        IF nvl(li.numnota, 0) = 0 THEN
            li.numnota := v_numnota;
        ELSIF li.numnota <> v_numnota THEN
            COMMIT;
            raise_application_error(-20001, li.numtransconhec
                                            || ' numnota pcconhecimentofretei difere numnota chavenfe li.numnota:'
                                            || li.numnota
                                            || ' numnotachave: '
                                            || v_numnota);

        END IF;

        v_existe := 0;
        SELECT
            COUNT(1)
        INTO v_existe
        FROM
            __FNV_GET_NOMESCHEMA__.dados_vendas_origem a
        WHERE
            a.nro_nfsa = li.numnota
            AND a.cod_unid = li.codfilial
            AND a.dt_emissao_nfsa BETWEEN add_months(li.dtemissaocte, - 6) AND li.dtemissaocte;

        IF v_existe > 0 THEN
            SELECT
                MAX(a.dt_emissao_nfsa)
            INTO li.dtemissao
            FROM
                __FNV_GET_NOMESCHEMA__.dados_vendas_origem a
            WHERE
                a.nro_nfsa = li.numnota
                AND a.cod_unid = li.codfilial
                AND a.dt_emissao_nfsa BETWEEN add_months(li.dtemissaocte, - 6) AND li.dtemissaocte;

            UPDATE jumbo.pcconhecimentofretei i
            SET
                i.numnotaaur = li.numnota,
                i.codfilialaur = li.codfilial,
                i.dtemissaoaur = li.dtemissao
            WHERE
                i.numtransconhec = li.numtransconhec
                AND i.numtransitem = li.numtransitem;

        END IF;

    END LOOP;

    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        dbms_output.put_line(sqlerrm
                             || chr(10)
                             || dbms_utility.format_error_backtrace);
END atualizar_fretesaur_com_vendas;",
        "codsituacaoregistro":1
	},
	"atualizar_vendasaur_com_fretes":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
CREATE OR REPLACE PROCEDURE atualizar_vendasaur_com_fretes (
    p_dtini   DATE DEFAULT sysdate,
    p_dtfim   DATE DEFAULT sysdate
) AS



    /*
        Regra de Negocio: Analisar vinculo entre ctes e vendas aurora



        Este processo: preenche o campo numtransconhec e chavenfeinfcte na tabela dados_vendas_origem se existir correspondencia
        na tabela pcconhecimentofretei.



        Importante: Executar com dbms_output habilitado. Se o numnota preenchido na pconhecimentofretei nao corresponder ao 
        numero da nota encontrado na chavenfe sera gerado um erro e interrompido o processo para que este dado seja corrigido



        Autor: Antonio Alencar Velozo
        Criacao: 17/11/2020        
    */
    v_existe    NUMBER;
    v_numnota   NUMBER;
BEGIN
    FOR li IN (
        SELECT
            fi.*,
            s.codfilial,
            s.dtsaida AS dtemissaocte
        FROM
            jumbo.pcconhecimentofretei   fi
            JOIN jumbo.pcnfsaid               s ON ( s.numtransvenda = fi.numtransconhec
                                       AND s.especie = 'CO'
                                       AND s.numtransvendaorigem IS NULL )
        WHERE
            s.dtsaida BETWEEN p_dtini AND p_dtfim
            AND s.dtcancel IS NULL
    ) LOOP
        v_numnota := substr(li.chavenfe, 26, 9);
        IF nvl(li.numnota, 0) = 0 THEN
            li.numnota := v_numnota;
        ELSIF li.numnota <> v_numnota THEN
            COMMIT;
            raise_application_error(-20001, li.numtransconhec
                                            || ' numnota pcconhecimentofretei difere numnota chavenfe li.numnota:'
                                            || li.numnota
                                            || ' numnotachave: '
                                            || v_numnota);

        END IF;

        v_existe := 0;
        SELECT
            COUNT(1)
        INTO v_existe
        FROM
            __FNV_GET_NOMESCHEMA__.dados_vendas_origem a
        WHERE
            a.nro_nfsa = li.numnota
            AND a.cod_unid = li.codfilial
            AND a.dt_emissao_nfsa BETWEEN add_months(li.dtemissaocte, - 6) AND li.dtemissaocte;

        IF v_existe > 0 THEN
            UPDATE __FNV_GET_NOMESCHEMA__.dados_vendas_origem a
            SET
                a.numtransconhec = li.numtransconhec,
                a.chavenfeinfcte = li.chavecte,
                a.numtransconhecitem = li.numtransitem
            WHERE
                a.nro_nfsa = li.numnota
                AND a.cod_unid = li.codfilial
                AND a.dt_emissao_nfsa BETWEEN add_months(li.dtemissaocte, - 6) AND li.dtemissaocte;

        END IF;

    END LOOP;

    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        dbms_output.put_line(sqlerrm
                             || chr(10)
                             || dbms_utility.format_error_backtrace);
END atualizar_vendasaur_com_fretes;",
        "codsituacaoregistro":1
	},
	"atualizardtentsaidaqt":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
CREATE OR REPLACE PROCEDURE atualizardtentsaidaqt (
    p_recriar   BOOLEAN,
    p_ano       NUMBER
) AS
    v_existe      NUMBER DEFAULT 0;
    v_dtinibase   DATE DEFAULT '01/01/2019';
    v_mes         NUMBER DEFAULT 1;
BEGIN
    IF ( p_recriar = true ) THEN
        DELETE FROM __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts;

        COMMIT;
        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts (
            codfilial,
            codprod,
            ano
        )
            SELECT
                f.codigo,
                p.codprod,
                p_ano
            FROM
                jumbo.pcfilial   f
                LEFT OUTER JOIN jumbo.pcprodut   p ON ( 1 = 1 )
            WHERE
                f.codigo <> 99
            ORDER BY
                1,
                2;

    END IF;



    /*atualizacao dtultentjumbo mes 1 a 12*/

    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                e.codfilial AS codfilial,
                m.codprod,
                CASE
                    WHEN MAX(nvl(m.dtmov, TO_DATE('01/01/2000', 'dd/mm/yyyy'))) = TO_DATE('01/01/2000', 'dd/mm/yyyy') THEN
                        NULL
                    ELSE
                        MAX(nvl(m.dtmov, TO_DATE('01/01/2000', 'dd/mm/yyyy')))
                END AS data
            FROM
                jumbo.pcnfent   e
                JOIN jumbo.pcmov     m ON ( m.numtransent = e.numtransent )
            WHERE
                e.dtent BETWEEN v_dtinibase AND last_day(to_date('01/'
                                                                 || lpad(v_mes, 2, '0')
                                                                 || '/'
                                                                 || p_ano, 'dd/mm/yyyy'))
                AND e.dtcancel IS NULL
                AND m.dtcancel IS NULL
                AND m.codoper = 'E'
            GROUP BY
                e.codfilial,
                m.codprod
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom1 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom2 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom3 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom4 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom5 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom6 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom7 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom8 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom9 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom10 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom11 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentjumbom12 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao dtultsaidajumbo mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                s.codfilial AS codfilial,
                m.codprod,
                CASE
                    WHEN MAX(nvl(m.dtmov, TO_DATE('01/01/2000', 'dd/mm/yyyy'))) = TO_DATE('01/01/2000', 'dd/mm/yyyy') THEN
                        NULL
                    ELSE
                        MAX(nvl(m.dtmov, TO_DATE('01/01/2000', 'dd/mm/yyyy')))
                END AS data
            FROM
                jumbo.pcnfsaid   s
                JOIN jumbo.pcmov      m ON ( m.numtransvenda = s.numtransvenda )
            WHERE
                s.dtsaida BETWEEN v_dtinibase AND last_day(to_date('01/'
                                                                   || lpad(v_mes, 2, '0')
                                                                   || '/'
                                                                   || p_ano, 'dd/mm/yyyy'))
                AND s.dtcancel IS NULL
                AND m.dtcancel IS NULL
                AND m.codoper = 'S'
            GROUP BY
                s.codfilial,
                m.codprod
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom1 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom2 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom3 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom4 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom5 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom6 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom7 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom8 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom9 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom10 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom11 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidajumbom12 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao qtentjumbo mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                e.codfilial AS codfilial,
                m.codprod,
                SUM(nvl(nvl(m.qt, m.qtcont), 0)) AS qt
            FROM
                jumbo.pcnfent   e
                JOIN jumbo.pcmov     m ON ( m.numtransent = e.numtransent )
            WHERE
                e.dtent BETWEEN to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/2020', 'dd/mm/yyyy') AND last_day(to_date('01/'
                                                                                       || lpad(v_mes, 2, '0')
                                                                                       || '/2020', 'dd/mm/yyyy'))
                AND e.dtcancel IS NULL
                AND m.dtcancel IS NULL
                AND m.codoper = 'E'
            GROUP BY
                e.codfilial,
                m.codprod
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom1 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom2 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom3 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom4 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom5 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom6 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom7 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom8 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom9 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom10 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom11 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentjumbom12 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao qtsaidajumbo mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                s.codfilial AS codfilial,
                m.codprod,
                SUM(nvl(nvl(m.qt, m.qtcont), 0)) AS qt
            FROM
                jumbo.pcnfsaid   s
                JOIN jumbo.pcmov      m ON ( m.numtransvenda = s.numtransvenda )
            WHERE
                s.dtsaida BETWEEN to_date('01/'
                                          || lpad(v_mes, 2, '0')
                                          || '/2020', 'dd/mm/yyyy') AND last_day(to_date('01/'
                                                                                         || lpad(v_mes, 2, '0')
                                                                                         || '/2020', 'dd/mm/yyyy'))
                AND s.dtcancel IS NULL
                AND m.dtcancel IS NULL
                AND m.codoper = 'S'
            GROUP BY
                s.codfilial,
                m.codprod
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom1 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom2 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom3 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom4 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom5 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom6 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom7 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom8 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom9 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom10 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom11 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidajumbom12 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
   
    
    /*atualizacao dtultentaur mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                eo.codfilial_erp AS codfilial,
                eo.codprod_erp as codprod,
                CASE
                    WHEN MAX(nvl(ah.dtmov, TO_DATE('01/01/2000', 'dd/mm/yyyy'))) = TO_DATE('01/01/2000', 'dd/mm/yyyy') THEN
                        NULL
                    ELSE
                        MAX(nvl(ah.dtmov, TO_DATE('01/01/2000', 'dd/mm/yyyy')))
                END AS data
            FROM
                __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__histest_origem ah
                join __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__estoque_origem eo on (eo.coditemest = ah.coditemest)
            WHERE
                ah.dtmov BETWEEN v_dtinibase AND last_day(to_date('01/'
                                                                  || lpad(v_mes, 2, '0')
                                                                  || '/'
                                                                  || p_ano, 'dd/mm/yyyy'))
                AND ah.codoper = 'E'
            GROUP BY
                eo.codfilial_erp,
                eo.codprod_erp
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm1 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm2 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm3 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm4 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm5 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm6 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm7 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm8 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm9 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm10 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm11 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultentorigemm12 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao dtultsaidaaur mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                da.cod_unid   AS codfilial,
                da.cd_item    AS codprod,
                CASE
                    WHEN MAX(nvl(da.dt_emissao_nfsa, TO_DATE('01/01/2000', 'dd/mm/yyyy'))) = TO_DATE('01/01/2000', 'dd/mm/yyyy') THEN
                        NULL
                    ELSE
                        MAX(nvl(da.dt_emissao_nfsa, TO_DATE('01/01/2000', 'dd/mm/yyyy')))
                END AS data
            FROM
                __FNV_GET_NOMESCHEMA__.dados_vendas_origem da
            WHERE
                da.dt_emissao_nfsa BETWEEN v_dtinibase AND last_day(to_date('01/'
                                                                            || lpad(v_mes, 2, '0')
                                                                            || '/'
                                                                            || p_ano, 'dd/mm/yyyy'))
            GROUP BY
                da.cod_unid,
                da.cd_item
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm1 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm2 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm3 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm4 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm5 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm6 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm7 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm8 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm9 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm10 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm11 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    ultsaidaorigemm12 = l.data
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao qtentaur mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                eo.codfilial_erp AS codfilial,
                eo.codprod_erp as codprod,
                SUM(nvl(ah.qtmov, 0)) AS qt
            FROM
                __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__histest_origem ah
                join __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__estoque_origem eo on (eo.coditemest = ah.coditemest)
            WHERE
                ah.dtmov BETWEEN to_date('01/'
                                         || lpad(v_mes, 2, '0')
                                         || '/'
                                         || p_ano, 'dd/mm/yyyy') AND last_day(to_date('01/'
                                                                                      || lpad(v_mes, 2, '0')
                                                                                      || '/'
                                                                                      || p_ano, 'dd/mm/yyyy'))
                AND ah.codoper = 'E'
            GROUP BY
                eo.codfilial_erp,
                eo.codprod_erp
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm1 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm2 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm3 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm4 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm5 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm6 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm7 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm8 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm9 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm10 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm11 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtentorigemm12 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao qtsaidaaur mes 1 a 12*/
    v_mes := 1;
    LOOP
        FOR l IN (
            SELECT
                da.cod_unid   AS codfilial,
                da.cd_item    AS codprod,
                SUM(nvl(da.qtde_liquida_item, 0)) AS qt
            FROM
                __FNV_GET_NOMESCHEMA__.dados_vendas_origem da
            WHERE
                da.dt_emissao_nfsa BETWEEN to_date('01/'
                                                   || lpad(v_mes, 2, '0')
                                                   || '/2020', 'dd/mm/yyyy') AND last_day(to_date('01/'
                                                                                                  || lpad(v_mes, 2, '0')
                                                                                                  || '/2020', 'dd/mm/yyyy'))
            GROUP BY
                da.cod_unid,
                da.cd_item
            ORDER BY
                1,
                2
        ) LOOP CASE v_mes
            WHEN 1 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm1 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 2 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm2 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 3 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm3 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 4 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm4 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 5 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm5 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 6 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm6 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 7 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm7 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 8 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm8 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 9 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm9 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 10 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm10 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 11 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm11 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

            WHEN 12 THEN
                UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
                SET
                    qtsaidaorigemm12 = l.qt
                WHERE
                    codfilial = l.codfilial
                    AND codprod = l.codprod
                    AND ano = p_ano;

        END CASE;
        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12 OR to_date('01/'
                                        || lpad(v_mes, 2, '0')
                                        || '/'
                                        || p_ano, 'dd/mm/yyyy') > trunc(sysdate);

    END LOOP;

    COMMIT;
    
    
    /*atualizacao qtmovtotaljumbom1,qtmovresjumbom1 e movimentoujumbo mes 1 a 12*/
    UPDATE __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts
    SET
        ultentgeralm1 = greatest(nvl(ultentjumbom1, ultentorigemm1), nvl(ultentorigemm1, ultentjumbom1)),
        ultentgeralm2 = greatest(nvl(ultentjumbom2, ultentorigemm2), nvl(ultentorigemm2, ultentjumbom2)),
        ultentgeralm3 = greatest(nvl(ultentjumbom3, ultentorigemm3), nvl(ultentorigemm3, ultentjumbom3)),
        ultentgeralm4 = greatest(nvl(ultentjumbom4, ultentorigemm4), nvl(ultentorigemm4, ultentjumbom4)),
        ultentgeralm5 = greatest(nvl(ultentjumbom5, ultentorigemm5), nvl(ultentorigemm5, ultentjumbom5)),
        ultentgeralm6 = greatest(nvl(ultentjumbom6, ultentorigemm6), nvl(ultentorigemm6, ultentjumbom6)),
        ultentgeralm7 = greatest(nvl(ultentjumbom7, ultentorigemm7), nvl(ultentorigemm7, ultentjumbom7)),
        ultentgeralm8 = greatest(nvl(ultentjumbom8, ultentorigemm8), nvl(ultentorigemm8, ultentjumbom8)),
        ultentgeralm9 = greatest(nvl(ultentjumbom9, ultentorigemm9), nvl(ultentorigemm9, ultentjumbom9)),
        ultentgeralm10 = greatest(nvl(ultentjumbom10, ultentorigemm10), nvl(ultentorigemm10, ultentjumbom10)),
        ultentgeralm11 = greatest(nvl(ultentjumbom11, ultentorigemm11), nvl(ultentorigemm11, ultentjumbom11)),
        ultentgeralm12 = greatest(nvl(ultentjumbom12, ultentorigemm12), nvl(ultentorigemm12, ultentjumbom12)),
        ultsaidageralm1 = greatest(nvl(ultsaidajumbom1, ultsaidaorigemm1), nvl(ultsaidaorigemm1, ultsaidajumbom1)),
        ultsaidageralm2 = greatest(nvl(ultsaidajumbom2, ultsaidaorigemm2), nvl(ultsaidaorigemm2, ultsaidajumbom2)),
        ultsaidageralm3 = greatest(nvl(ultsaidajumbom3, ultsaidaorigemm3), nvl(ultsaidaorigemm3, ultsaidajumbom3)),
        ultsaidageralm4 = greatest(nvl(ultsaidajumbom4, ultsaidaorigemm4), nvl(ultsaidaorigemm4, ultsaidajumbom4)),
        ultsaidageralm5 = greatest(nvl(ultsaidajumbom5, ultsaidaorigemm5), nvl(ultsaidaorigemm5, ultsaidajumbom5)),
        ultsaidageralm6 = greatest(nvl(ultsaidajumbom6, ultsaidaorigemm6), nvl(ultsaidaorigemm6, ultsaidajumbom6)),
        ultsaidageralm7 = greatest(nvl(ultsaidajumbom7, ultsaidaorigemm7), nvl(ultsaidaorigemm7, ultsaidajumbom7)),
        ultsaidageralm8 = greatest(nvl(ultsaidajumbom8, ultsaidaorigemm8), nvl(ultsaidaorigemm8, ultsaidajumbom8)),
        ultsaidageralm9 = greatest(nvl(ultsaidajumbom9, ultsaidaorigemm9), nvl(ultsaidaorigemm9, ultsaidajumbom9)),
        ultsaidageralm10 = greatest(nvl(ultsaidajumbom10, ultsaidaorigemm10), nvl(ultsaidaorigemm10, ultsaidajumbom10)),
        ultsaidageralm11 = greatest(nvl(ultsaidajumbom11, ultsaidaorigemm11), nvl(ultsaidaorigemm11, ultsaidajumbom11)),
        ultsaidageralm12 = greatest(nvl(ultsaidajumbom12, ultsaidaorigemm12), nvl(ultsaidaorigemm12, ultsaidajumbom12)),
        qtmovtotaljumbom1 = nvl(qtentjumbom1, 0) + nvl(qtsaidajumbom1, 0),
        qtmovtotaljumbom2 = nvl(qtentjumbom2, 0) + nvl(qtsaidajumbom2, 0),
        qtmovtotaljumbom3 = nvl(qtentjumbom3, 0) + nvl(qtsaidajumbom3, 0),
        qtmovtotaljumbom4 = nvl(qtentjumbom4, 0) + nvl(qtsaidajumbom4, 0),
        qtmovtotaljumbom5 = nvl(qtentjumbom5, 0) + nvl(qtsaidajumbom5, 0),
        qtmovtotaljumbom6 = nvl(qtentjumbom6, 0) + nvl(qtsaidajumbom6, 0),
        qtmovtotaljumbom7 = nvl(qtentjumbom7, 0) + nvl(qtsaidajumbom7, 0),
        qtmovtotaljumbom8 = nvl(qtentjumbom8, 0) + nvl(qtsaidajumbom8, 0),
        qtmovtotaljumbom9 = nvl(qtentjumbom9, 0) + nvl(qtsaidajumbom9, 0),
        qtmovtotaljumbom10 = nvl(qtentjumbom10, 0) + nvl(qtsaidajumbom10, 0),
        qtmovtotaljumbom11 = nvl(qtentjumbom11, 0) + nvl(qtsaidajumbom11, 0),
        qtmovtotaljumbom12 = nvl(qtentjumbom12, 0) + nvl(qtsaidajumbom12, 0),
        qtmovresjumbom1 = nvl(qtentjumbom1, 0) - nvl(qtsaidajumbom1, 0),
        qtmovresjumbom2 = nvl(qtentjumbom2, 0) - nvl(qtsaidajumbom2, 0),
        qtmovresjumbom3 = nvl(qtentjumbom3, 0) - nvl(qtsaidajumbom3, 0),
        qtmovresjumbom4 = nvl(qtentjumbom4, 0) - nvl(qtsaidajumbom4, 0),
        qtmovresjumbom5 = nvl(qtentjumbom5, 0) - nvl(qtsaidajumbom5, 0),
        qtmovresjumbom6 = nvl(qtentjumbom6, 0) - nvl(qtsaidajumbom6, 0),
        qtmovresjumbom7 = nvl(qtentjumbom7, 0) - nvl(qtsaidajumbom7, 0),
        qtmovresjumbom8 = nvl(qtentjumbom8, 0) - nvl(qtsaidajumbom8, 0),
        qtmovresjumbom9 = nvl(qtentjumbom9, 0) - nvl(qtsaidajumbom9, 0),
        qtmovresjumbom10 = nvl(qtentjumbom10, 0) - nvl(qtsaidajumbom10, 0),
        qtmovresjumbom11 = nvl(qtentjumbom11, 0) - nvl(qtsaidajumbom11, 0),
        qtmovresjumbom12 = nvl(qtentjumbom12, 0) - nvl(qtsaidajumbom12, 0),
        movimentoujumbom1 =
            CASE
                WHEN nvl(qtentjumbom1, 0) + nvl(qtsaidajumbom1, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom2 =
            CASE
                WHEN nvl(qtentjumbom2, 0) + nvl(qtsaidajumbom2, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom3 =
            CASE
                WHEN nvl(qtentjumbom3, 0) + nvl(qtsaidajumbom3, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom4 =
            CASE
                WHEN nvl(qtentjumbom4, 0) + nvl(qtsaidajumbom4, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom5 =
            CASE
                WHEN nvl(qtentjumbom5, 0) + nvl(qtsaidajumbom5, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom6 =
            CASE
                WHEN nvl(qtentjumbom6, 0) + nvl(qtsaidajumbom6, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom7 =
            CASE
                WHEN nvl(qtentjumbom7, 0) + nvl(qtsaidajumbom7, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom8 =
            CASE
                WHEN nvl(qtentjumbom8, 0) + nvl(qtsaidajumbom8, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom9 =
            CASE
                WHEN nvl(qtentjumbom9, 0) + nvl(qtsaidajumbom9, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom10 =
            CASE
                WHEN nvl(qtentjumbom10, 0) + nvl(qtsaidajumbom10, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom11 =
            CASE
                WHEN nvl(qtentjumbom11, 0) + nvl(qtsaidajumbom11, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentoujumbom12 =
            CASE
                WHEN nvl(qtentjumbom12, 0) + nvl(qtsaidajumbom12, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        qtmovtotalorigemm1 = nvl(qtentorigemm1, 0) + nvl(qtsaidaorigemm1, 0),
        qtmovtotalorigemm2 = nvl(qtentorigemm2, 0) + nvl(qtsaidaorigemm2, 0),
        qtmovtotalorigemm3 = nvl(qtentorigemm3, 0) + nvl(qtsaidaorigemm3, 0),
        qtmovtotalorigemm4 = nvl(qtentorigemm4, 0) + nvl(qtsaidaorigemm4, 0),
        qtmovtotalorigemm5 = nvl(qtentorigemm5, 0) + nvl(qtsaidaorigemm5, 0),
        qtmovtotalorigemm6 = nvl(qtentorigemm6, 0) + nvl(qtsaidaorigemm6, 0),
        qtmovtotalorigemm7 = nvl(qtentorigemm7, 0) + nvl(qtsaidaorigemm7, 0),
        qtmovtotalorigemm8 = nvl(qtentorigemm8, 0) + nvl(qtsaidaorigemm8, 0),
        qtmovtotalorigemm9 = nvl(qtentorigemm9, 0) + nvl(qtsaidaorigemm9, 0),
        qtmovtotalorigemm10 = nvl(qtentorigemm10, 0) + nvl(qtsaidaorigemm10, 0),
        qtmovtotalorigemm11 = nvl(qtentorigemm11, 0) + nvl(qtsaidaorigemm11, 0),
        qtmovtotalorigemm12 = nvl(qtentorigemm12, 0) + nvl(qtsaidaorigemm12, 0),
        qtmovresorigemm1 = nvl(qtentorigemm1, 0) - nvl(qtsaidaorigemm1, 0),
        qtmovresorigemm2 = nvl(qtentorigemm2, 0) - nvl(qtsaidaorigemm2, 0),
        qtmovresorigemm3 = nvl(qtentorigemm3, 0) - nvl(qtsaidaorigemm3, 0),
        qtmovresorigemm4 = nvl(qtentorigemm4, 0) - nvl(qtsaidaorigemm4, 0),
        qtmovresorigemm5 = nvl(qtentorigemm5, 0) - nvl(qtsaidaorigemm5, 0),
        qtmovresorigemm6 = nvl(qtentorigemm6, 0) - nvl(qtsaidaorigemm6, 0),
        qtmovresorigemm7 = nvl(qtentorigemm7, 0) - nvl(qtsaidaorigemm7, 0),
        qtmovresorigemm8 = nvl(qtentorigemm8, 0) - nvl(qtsaidaorigemm8, 0),
        qtmovresorigemm9 = nvl(qtentorigemm9, 0) - nvl(qtsaidaorigemm9, 0),
        qtmovresorigemm10 = nvl(qtentorigemm10, 0) - nvl(qtsaidaorigemm10, 0),
        qtmovresorigemm11 = nvl(qtentorigemm11, 0) - nvl(qtsaidaorigemm11, 0),
        qtmovresorigemm12 = nvl(qtentorigemm12, 0) - nvl(qtsaidaorigemm12, 0),
        movimentouorigemm1 =
            CASE
                WHEN nvl(qtentorigemm1, 0) + nvl(qtsaidaorigemm1, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm2 =
            CASE
                WHEN nvl(qtentorigemm2, 0) + nvl(qtsaidaorigemm2, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm3 =
            CASE
                WHEN nvl(qtentorigemm3, 0) + nvl(qtsaidaorigemm3, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm4 =
            CASE
                WHEN nvl(qtentorigemm4, 0) + nvl(qtsaidaorigemm4, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm5 =
            CASE
                WHEN nvl(qtentorigemm5, 0) + nvl(qtsaidaorigemm5, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm6 =
            CASE
                WHEN nvl(qtentorigemm6, 0) + nvl(qtsaidaorigemm6, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm7 =
            CASE
                WHEN nvl(qtentorigemm7, 0) + nvl(qtsaidaorigemm7, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm8 =
            CASE
                WHEN nvl(qtentorigemm8, 0) + nvl(qtsaidaorigemm8, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm9 =
            CASE
                WHEN nvl(qtentorigemm9, 0) + nvl(qtsaidaorigemm9, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm10 =
            CASE
                WHEN nvl(qtentorigemm10, 0) + nvl(qtsaidaorigemm10, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm11 =
            CASE
                WHEN nvl(qtentorigemm11, 0) + nvl(qtsaidaorigemm11, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentouorigemm12 =
            CASE
                WHEN nvl(qtentorigemm12, 0) + nvl(qtsaidaorigemm12, 0) > 0 THEN
                    1
                ELSE
                    0
            END,
        qtentgeralm1 = nvl(qtentjumbom1, 0) + nvl(qtentorigemm1, 0),
        qtentgeralm2 = nvl(qtentjumbom2, 0) + nvl(qtentorigemm2, 0),
        qtentgeralm3 = nvl(qtentjumbom3, 0) + nvl(qtentorigemm3, 0),
        qtentgeralm4 = nvl(qtentjumbom4, 0) + nvl(qtentorigemm4, 0),
        qtentgeralm5 = nvl(qtentjumbom5, 0) + nvl(qtentorigemm5, 0),
        qtentgeralm6 = nvl(qtentjumbom6, 0) + nvl(qtentorigemm6, 0),
        qtentgeralm7 = nvl(qtentjumbom7, 0) + nvl(qtentorigemm7, 0),
        qtentgeralm8 = nvl(qtentjumbom8, 0) + nvl(qtentorigemm8, 0),
        qtentgeralm9 = nvl(qtentjumbom9, 0) + nvl(qtentorigemm9, 0),
        qtentgeralm10 = nvl(qtentjumbom10, 0) + nvl(qtentorigemm10, 0),
        qtentgeralm11 = nvl(qtentjumbom11, 0) + nvl(qtentorigemm11, 0),
        qtentgeralm12 = nvl(qtentjumbom12, 0) + nvl(qtentorigemm12, 0),
        qtsaidageralm1 = nvl(qtsaidajumbom1, 0) + nvl(qtsaidaorigemm1, 0),
        qtsaidageralm2 = nvl(qtsaidajumbom2, 0) + nvl(qtsaidaorigemm2, 0),
        qtsaidageralm3 = nvl(qtsaidajumbom3, 0) + nvl(qtsaidaorigemm3, 0),
        qtsaidageralm4 = nvl(qtsaidajumbom4, 0) + nvl(qtsaidaorigemm4, 0),
        qtsaidageralm5 = nvl(qtsaidajumbom5, 0) + nvl(qtsaidaorigemm5, 0),
        qtsaidageralm6 = nvl(qtsaidajumbom6, 0) + nvl(qtsaidaorigemm6, 0),
        qtsaidageralm7 = nvl(qtsaidajumbom7, 0) + nvl(qtsaidaorigemm7, 0),
        qtsaidageralm8 = nvl(qtsaidajumbom8, 0) + nvl(qtsaidaorigemm8, 0),
        qtsaidageralm9 = nvl(qtsaidajumbom9, 0) + nvl(qtsaidaorigemm9, 0),
        qtsaidageralm10 = nvl(qtsaidajumbom10, 0) + nvl(qtsaidaorigemm10, 0),
        qtsaidageralm11 = nvl(qtsaidajumbom11, 0) + nvl(qtsaidaorigemm11, 0),
        qtsaidageralm12 = nvl(qtsaidajumbom12, 0) + nvl(qtsaidaorigemm12, 0),
        qtmovtotalgeralm1 = nvl(qtentjumbom1, 0) + nvl(qtentorigemm1, 0) + nvl(qtsaidajumbom1, 0) + nvl(qtsaidaorigemm1, 0),
        qtmovtotalgeralm2 = nvl(qtentjumbom2, 0) + nvl(qtentorigemm2, 0) + nvl(qtsaidajumbom2, 0) + nvl(qtsaidaorigemm2, 0),
        qtmovtotalgeralm3 = nvl(qtentjumbom3, 0) + nvl(qtentorigemm3, 0) + nvl(qtsaidajumbom3, 0) + nvl(qtsaidaorigemm3, 0),
        qtmovtotalgeralm4 = nvl(qtentjumbom4, 0) + nvl(qtentorigemm4, 0) + nvl(qtsaidajumbom4, 0) + nvl(qtsaidaorigemm4, 0),
        qtmovtotalgeralm5 = nvl(qtentjumbom5, 0) + nvl(qtentorigemm5, 0) + nvl(qtsaidajumbom5, 0) + nvl(qtsaidaorigemm5, 0),
        qtmovtotalgeralm6 = nvl(qtentjumbom6, 0) + nvl(qtentorigemm6, 0) + nvl(qtsaidajumbom6, 0) + nvl(qtsaidaorigemm6, 0),
        qtmovtotalgeralm7 = nvl(qtentjumbom7, 0) + nvl(qtentorigemm7, 0) + nvl(qtsaidajumbom7, 0) + nvl(qtsaidaorigemm7, 0),
        qtmovtotalgeralm8 = nvl(qtentjumbom8, 0) + nvl(qtentorigemm8, 0) + nvl(qtsaidajumbom8, 0) + nvl(qtsaidaorigemm8, 0),
        qtmovtotalgeralm9 = nvl(qtentjumbom9, 0) + nvl(qtentorigemm9, 0) + nvl(qtsaidajumbom9, 0) + nvl(qtsaidaorigemm9, 0),
        qtmovtotalgeralm10 = nvl(qtentjumbom10, 0) + nvl(qtentorigemm10, 0) + nvl(qtsaidajumbom10, 0) + nvl(qtsaidaorigemm10, 0),
        qtmovtotalgeralm11 = nvl(qtentjumbom11, 0) + nvl(qtentorigemm11, 0) + nvl(qtsaidajumbom11, 0) + nvl(qtsaidaorigemm11, 0),
        qtmovtotalgeralm12 = nvl(qtentjumbom12, 0) + nvl(qtentorigemm12, 0) + nvl(qtsaidajumbom12, 0) + nvl(qtsaidaorigemm12, 0),
        qtmovresgeralm1 = ( nvl(qtentjumbom1, 0) + nvl(qtentorigemm1, 0) ) - ( nvl(qtsaidajumbom1, 0) + nvl(qtsaidaorigemm1, 0) ),
        qtmovresgeralm2 = ( nvl(qtentjumbom2, 0) + nvl(qtentorigemm2, 0) ) - ( nvl(qtsaidajumbom2, 0) + nvl(qtsaidaorigemm2, 0) ),
        qtmovresgeralm3 = ( nvl(qtentjumbom3, 0) + nvl(qtentorigemm3, 0) ) - ( nvl(qtsaidajumbom3, 0) + nvl(qtsaidaorigemm3, 0) ),
        qtmovresgeralm4 = ( nvl(qtentjumbom4, 0) + nvl(qtentorigemm4, 0) ) - ( nvl(qtsaidajumbom4, 0) + nvl(qtsaidaorigemm4, 0) ),
        qtmovresgeralm5 = ( nvl(qtentjumbom5, 0) + nvl(qtentorigemm5, 0) ) - ( nvl(qtsaidajumbom5, 0) + nvl(qtsaidaorigemm5, 0) ),
        qtmovresgeralm6 = ( nvl(qtentjumbom6, 0) + nvl(qtentorigemm6, 0) ) - ( nvl(qtsaidajumbom6, 0) + nvl(qtsaidaorigemm6, 0) ),
        qtmovresgeralm7 = ( nvl(qtentjumbom7, 0) + nvl(qtentorigemm7, 0) ) - ( nvl(qtsaidajumbom7, 0) + nvl(qtsaidaorigemm7, 0) ),
        qtmovresgeralm8 = ( nvl(qtentjumbom8, 0) + nvl(qtentorigemm8, 0) ) - ( nvl(qtsaidajumbom8, 0) + nvl(qtsaidaorigemm8, 0) ),
        qtmovresgeralm9 = ( nvl(qtentjumbom9, 0) + nvl(qtentorigemm9, 0) ) - ( nvl(qtsaidajumbom9, 0) + nvl(qtsaidaorigemm9, 0) ),
        qtmovresgeralm10 = ( nvl(qtentjumbom10, 0) + nvl(qtentorigemm10, 0) ) - ( nvl(qtsaidajumbom10, 0) + nvl(qtsaidaorigemm10, 0) ),
        qtmovresgeralm11 = ( nvl(qtentjumbom11, 0) + nvl(qtentorigemm11, 0) ) - ( nvl(qtsaidajumbom11, 0) + nvl(qtsaidaorigemm11, 0) ),
        qtmovresgeralm12 = ( nvl(qtentjumbom12, 0) + nvl(qtentorigemm12, 0) ) - ( nvl(qtsaidajumbom12, 0) + nvl(qtsaidaorigemm12, 0) ),
        movimentougeralm1 =
            CASE
                WHEN ( nvl(qtentjumbom1, 0) + nvl(qtentorigemm1, 0) + nvl(qtsaidajumbom1, 0) + nvl(qtsaidaorigemm1, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm2 =
            CASE
                WHEN ( nvl(qtentjumbom2, 0) + nvl(qtentorigemm2, 0) + nvl(qtsaidajumbom2, 0) + nvl(qtsaidaorigemm2, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm3 =
            CASE
                WHEN ( nvl(qtentjumbom3, 0) + nvl(qtentorigemm3, 0) + nvl(qtsaidajumbom3, 0) + nvl(qtsaidaorigemm3, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm4 =
            CASE
                WHEN ( nvl(qtentjumbom4, 0) + nvl(qtentorigemm4, 0) + nvl(qtsaidajumbom4, 0) + nvl(qtsaidaorigemm4, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm5 =
            CASE
                WHEN ( nvl(qtentjumbom5, 0) + nvl(qtentorigemm5, 0) + nvl(qtsaidajumbom5, 0) + nvl(qtsaidaorigemm5, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm6 =
            CASE
                WHEN ( nvl(qtentjumbom6, 0) + nvl(qtentorigemm6, 0) + nvl(qtsaidajumbom6, 0) + nvl(qtsaidaorigemm6, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm7 =
            CASE
                WHEN ( nvl(qtentjumbom7, 0) + nvl(qtentorigemm7, 0) + nvl(qtsaidajumbom7, 0) + nvl(qtsaidaorigemm7, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm8 =
            CASE
                WHEN ( nvl(qtentjumbom8, 0) + nvl(qtentorigemm8, 0) + nvl(qtsaidajumbom8, 0) + nvl(qtsaidaorigemm8, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm9 =
            CASE
                WHEN ( nvl(qtentjumbom9, 0) + nvl(qtentorigemm9, 0) + nvl(qtsaidajumbom9, 0) + nvl(qtsaidaorigemm9, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm10 =
            CASE
                WHEN ( nvl(qtentjumbom10, 0) + nvl(qtentorigemm10, 0) + nvl(qtsaidajumbom10, 0) + nvl(qtsaidaorigemm10, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm11 =
            CASE
                WHEN ( nvl(qtentjumbom11, 0) + nvl(qtentorigemm11, 0) + nvl(qtsaidajumbom11, 0) + nvl(qtsaidaorigemm11, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END,
        movimentougeralm12 =
            CASE
                WHEN ( nvl(qtentjumbom12, 0) + nvl(qtentorigemm12, 0) + nvl(qtsaidajumbom12, 0) + nvl(qtsaidaorigemm12, 0) ) > 0 THEN
                    1
                ELSE
                    0
            END;

    COMMIT;
END atualizardtentsaidaqt;",
        "codsituacaoregistro":1
	},
	"corrigir_obje_itens_grup":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
CREATE OR REPLACE PROCEDURE corrigir_obje_itens_grup AS

    v_existe   NUMBER;
    qtincl     NUMBER DEFAULT 0;
    qtupdt     NUMBER DEFAULT 0;
    qtdel      NUMBER DEFAULT 0;
    v_numreg   NUMBER DEFAULT 0;
BEGIN
    FOR li IN (
        SELECT
            o.*,
            g.codgrupoprod,
            g.codvisivelgrupo
        FROM
            __FNV_GET_PREFIXOBJECTSDB__objetivossinergia   o
            JOIN __FNV_GET_PREFIXOBJECTSDB__integgrupoprod      ig ON ( to_char(ig.codprod) = o.coditemvisao )
            JOIN __FNV_GET_PREFIXOBJECTSDB__gruposprodequiv     g ON ( g.codgrupoprod = ig.codgrupoprod )
    ) LOOP
        v_existe := 0;
        SELECT
            COUNT(1)
        INTO v_existe
        FROM
            __FNV_GET_PREFIXOBJECTSDB__objetivossinergia o
        WHERE
            o.coditemvisao = li.codvisivelgrupo
            AND o.codentidade = li.codentidade
            AND o.ano = li.ano
            AND o.mes = li.mes;

        IF v_existe > 0 THEN
            UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivossinergia o
            SET
                o.valor = nvl(o.valor, 0) + nvl(li.valor, 0),
                o.realizado = nvl(o.realizado, 0) + nvl(li.realizado, 0)
            WHERE
                o.ano = li.ano
                AND o.mes = li.mes
                AND o.codentidade = li.codentidade
                AND o.coditemvisao = li.codvisivelgrupo;

            qtupdt := qtupdt + 1;
        ELSE
            IF v_numreg = 0 THEN
                SELECT
                    MAX(o2.codobjetivosinergia)
                INTO v_numreg
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivossinergia o2;

            END IF;

            v_numreg := v_numreg + 1;
            INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivossinergia (
                codobjetivosinergia,
                codcampanhasinergia,
                entidade,
                codentidade,
                visao,
                coditemvisao,
                unidade,
                valor,
                percmaxating,
                mes,
                ano,
                realizado,
                codgrupogiro
            ) VALUES (
                v_numreg,
                li.codcampanhasinergia,
                li.entidade,
                li.codentidade,
                li.visao,
                li.codgrupogiro,
                li.unidade,
                li.valor,
                li.percmaxating,
                li.mes,
                li.ano,
                li.realizado,
                li.codgrupogiro
            );

            qtincl := qtincl + 1;
        END IF;

        DELETE FROM __FNV_GET_PREFIXOBJECTSDB__objetivossinergia o
        WHERE
            o.codobjetivosinergia = li.codobjetivosinergia;

        qtdel := qtdel + 1;
        COMMIT;
    END LOOP;

    dbms_output.put_line('atualizados: ' || qtupdt);
    dbms_output.put_line('incluidos: ' || qtincl);
    dbms_output.put_line('excluidos: ' || qtdel);
END corrigir_obje_itens_grup;",
        "codsituacaoregistro":1
	},
	"simularobjetivosano":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
CREATE OR REPLACE PROCEDURE simularobjetivosano (
    p_limpar   BOOLEAN,
    p_ano      NUMBER
) AS

    v_mes                   NUMBER DEFAULT 1;
    v_mes_texto             VARCHAR2(100) DEFAULT NULL;
    v_existe                NUMBER DEFAULT 0;
    qtexcluirmesanterior    NUMBER DEFAULT 0;
    qtitensmantermesatual   NUMBER DEFAULT 0;
    qtjaincluidamesatual    NUMBER DEFAULT 0;
    peso1cx                 NUMBER DEFAULT 0;
    qtnovoobjet             NUMBER DEFAULT 0;
BEGIN
    IF p_limpar = true THEN
        DELETE FROM __FNV_GET_PREFIXOBJECTSDB__objetivosano;

        COMMIT;
    END IF;
    v_mes := 1;
    LOOP
        v_mes_texto := upper(trim(mes_texto(v_mes)));
        FOR l IN (
            SELECT
                u.codfilial,
                f.cidade         AS filial,
                u.codsupervisor,
                s.nome           AS nomesupervisor,
                o.codentidade    AS codrca,
                u.nome           AS nomerca,
                o.codgrupogiro,
                gg.nomegrupogiro,
                o.coditemvisao   AS codprod,
                nvl(g.nomegrupoprod, p.descricao) AS descricao,
                o.ano            AS ano,
                o.valor          AS objetivooriginal,
                o.realizado      AS realizado,
                (
                    SELECT
                        CASE v_mes
                            WHEN 1    THEN
                                SUM(nvl(mv.qtmovtotalgeralm1, 0))
                            WHEN 2    THEN
                                SUM(nvl(mv.qtmovtotalgeralm2, 0))
                            WHEN 3    THEN
                                SUM(nvl(mv.qtmovtotalgeralm3, 0))
                            WHEN 4    THEN
                                SUM(nvl(mv.qtmovtotalgeralm4, 0))
                            WHEN 5    THEN
                                SUM(nvl(mv.qtmovtotalgeralm5, 0))
                            WHEN 6    THEN
                                SUM(nvl(mv.qtmovtotalgeralm6, 0))
                            WHEN 7    THEN
                                SUM(nvl(mv.qtmovtotalgeralm7, 0))
                            WHEN 8    THEN
                                SUM(nvl(mv.qtmovtotalgeralm8, 0))
                            WHEN 9    THEN
                                SUM(nvl(mv.qtmovtotalgeralm9, 0))
                            WHEN 10   THEN
                                SUM(nvl(mv.qtmovtotalgeralm10, 0))
                            WHEN 11   THEN
                                SUM(nvl(mv.qtmovtotalgeralm11, 0))
                            WHEN 12   THEN
                                SUM(nvl(mv.qtmovtotalgeralm12, 0))
                            ELSE
                                NULL
                        END AS qtmovtotalgeral
                    FROM
                        __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts mv
                    WHERE
                        mv.codfilial = f.codigo
                        AND mv.ano = o.ano
                        AND ( to_char(mv.codprod) = to_char(o.coditemvisao)
                              OR to_char((
                            SELECT
                                gp1.codvisivelgrupo
                            FROM
                                __FNV_GET_PREFIXOBJECTSDB__gruposprodequiv gp1
                            WHERE
                                gp1.codgrupoprod =(
                                    SELECT
                                        itg1.codgrupoprod
                                    FROM
                                        __FNV_GET_PREFIXOBJECTSDB__integgrupoprod itg1
                                    WHERE
                                        itg1.codprod = mv.codprod
                                )
                        )) = to_char(o.coditemvisao) )
                ) AS qtmovtotalgeral
            FROM
                __FNV_GET_PREFIXOBJECTSDB__objetivossinergia          o
                LEFT OUTER JOIN jumbo.pcusuari                u ON ( u.codusur = o.codentidade )
                LEFT OUTER JOIN jumbo.pcfilial                f ON ( f.codigo = u.codfilial )
                LEFT OUTER JOIN jumbo.pcsuperv                s ON ( s.codsupervisor = u.codsupervisor )
                LEFT OUTER JOIN jumbo.pcprodut                p ON ( to_char(p.codprod) = o.coditemvisao )
                LEFT OUTER JOIN __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__gruposprodequiv   g ON ( g.codvisivelgrupo = o.coditemvisao )
                LEFT OUTER JOIN __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__gruposgiro        gg ON ( gg.codgrupogiro = o.codgrupogiro )
            WHERE
                o.codcampanhasinergia = 0
                AND lower(TRIM(o.entidade)) = lower(TRIM('rca'))
                AND lower(TRIM(o.visao)) = lower(TRIM('produto'))
                AND lower(TRIM(o.unidade)) = lower(TRIM('kg'))
                AND o.ano = p_ano
                AND upper(TRIM(o.mes)) = v_mes_texto
            ORDER BY
                1,
                3,
                5,
                7,
                9
        ) LOOP
            v_existe := 0;
            SELECT
                COUNT(1)
            INTO v_existe
            FROM
                __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
            WHERE
                oa.codfilial = l.codfilial
                AND oa.codsupervisor = l.codsupervisor
                AND oa.codrca = l.codrca
                AND oa.codgrupogiro = l.codgrupogiro
                AND oa.codprod = l.codprod
                AND oa.ano = l.ano;

            IF v_existe = 0 THEN
                CASE v_mes
                    WHEN 1 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm1,
                            realizadom1,
                            qtmovm1
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 2 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm2,
                            realizadom2,
                            qtmovm2
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 3 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm3,
                            realizadom3,
                            qtmovm3
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 4 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm4,
                            realizadom4,
                            qtmovm4
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 5 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm5,
                            realizadom5,
                            qtmovm5
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 6 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm6,
                            realizadom6,
                            qtmovm6
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 7 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm7,
                            realizadom7,
                            qtmovm7
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 8 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm8,
                            realizadom8,
                            qtmovm8
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 9 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm9,
                            realizadom9,
                            qtmovm9
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 10 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm10,
                            realizadom10,
                            qtmovm10
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 11 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm11,
                            realizadom11,
                            qtmovm11
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 12 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm12,
                            realizadom12,
                            qtmovm12
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    ELSE
                        NULL;
                END CASE;
            ELSE
                CASE v_mes
                    WHEN 1 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm1 = l.objetivooriginal,
                            oa.realizadom1 = l.realizado,
                            oa.qtmovm1 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 2 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm2 = l.objetivooriginal,
                            oa.realizadom2 = l.realizado,
                            oa.qtmovm2 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 3 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm3 = l.objetivooriginal,
                            oa.realizadom3 = l.realizado,
                            oa.qtmovm3 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 4 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm4 = l.objetivooriginal,
                            oa.realizadom4 = l.realizado,
                            oa.qtmovm4 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 5 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm5 = l.objetivooriginal,
                            oa.realizadom5 = l.realizado,
                            oa.qtmovm5 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 6 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm6 = l.objetivooriginal,
                            oa.realizadom6 = l.realizado,
                            oa.qtmovm6 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 7 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm7 = l.objetivooriginal,
                            oa.realizadom7 = l.realizado,
                            oa.qtmovm7 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 8 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm8 = l.objetivooriginal,
                            oa.realizadom8 = l.realizado,
                            oa.qtmovm8 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 9 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm9 = l.objetivooriginal,
                            oa.realizadom9 = l.realizado,
                            oa.qtmovm9 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 10 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm10 = l.objetivooriginal,
                            oa.realizadom10 = l.realizado,
                            oa.qtmovm10 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 11 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm11 = l.objetivooriginal,
                            oa.realizadom11 = l.realizado,
                            oa.qtmovm11 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 12 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm12 = l.objetivooriginal,
                            oa.realizadom12 = l.realizado,
                            oa.qtmovm12 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    ELSE
                        NULL;
                END CASE;
            END IF;

        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12;
    END LOOP;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom1 =
            CASE
                WHEN nvl(oa.qtmovm1, 0) > 0 THEN
                    oa.objetivooriginalm1
                ELSE
                    0
            END,
        oa.novoobjetivom2 =
            CASE
                WHEN nvl(oa.qtmovm2, 0) > 0 THEN
                    oa.objetivooriginalm2
                ELSE
                    0
            END,
        oa.novoobjetivom3 =
            CASE
                WHEN nvl(oa.qtmovm3, 0) > 0 THEN
                    oa.objetivooriginalm3
                ELSE
                    0
            END,
        oa.novoobjetivom4 =
            CASE
                WHEN nvl(oa.qtmovm4, 0) > 0 THEN
                    oa.objetivooriginalm4
                ELSE
                    0
            END,
        oa.novoobjetivom5 =
            CASE
                WHEN nvl(oa.qtmovm5, 0) > 0 THEN
                    oa.objetivooriginalm5
                ELSE
                    0
            END,
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.qtmovm6, 0) > 0 THEN
                    oa.objetivooriginalm6
                ELSE
                    0
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.qtmovm7, 0) > 0 THEN
                    oa.objetivooriginalm7
                ELSE
                    0
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.qtmovm8, 0) > 0 THEN
                    oa.objetivooriginalm8
                ELSE
                    0
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.qtmovm9, 0) > 0 THEN
                    oa.objetivooriginalm9
                ELSE
                    0
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.qtmovm10, 0) > 0 THEN
                    oa.objetivooriginalm10
                ELSE
                    0
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.qtmovm11, 0) > 0 THEN
                    oa.objetivooriginalm11
                ELSE
                    0
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.qtmovm12, 0) > 0 THEN
                    oa.objetivooriginalm12
                ELSE
                    0
            END;

    COMMIT;
    DELETE FROM __FNV_GET_PREFIXOBJECTSDB__gruposexcluir;

    COMMIT;
    INSERT INTO __FNV_GET_PREFIXOBJECTSDB__gruposexcluir
        SELECT
            oa.codfilial,
            oa.codsupervisor,
            oa.codrca,
            oa.codgrupogiro,
            oa.ano,
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm1, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom1, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom1, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom1, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm1, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm2, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm2, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm3, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm3, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm4, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm4, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm5, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm5, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm6, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm6, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm7, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm7, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm8, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm8, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm9, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm9, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm10, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm10, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm11, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm11, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm12, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm12, 0)
                END
            )
        FROM
            __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
        GROUP BY
            oa.codfilial,
            oa.codsupervisor,
            oa.codrca,
            oa.codgrupogiro,
            oa.ano;

    COMMIT;
    FOR l IN (
        SELECT
            *
        FROM
            __FNV_GET_PREFIXOBJECTSDB__objetivosano
    ) LOOP
        v_existe := 0;
        SELECT
            COUNT(1)
        INTO v_existe
        FROM
            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
        WHERE
            ex.codfilial = l.codfilial
            AND ex.codsupervisor = l.codsupervisor
            AND ex.codrca = l.codrca
            AND ex.codgrupogiro = l.codgrupogiro
            AND ex.ano = l.ano;

        IF v_existe > 0 THEN
            SELECT
                nvl((MAX(nvl(p.pesoliq, 1)) * MAX(nvl(p.qtunitcx, 1))), 1)
            INTO peso1cx
            FROM
                jumbo.pcprodut                p
                LEFT OUTER JOIN __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__integgrupoprod    ig ON ( ig.codprod = p.codprod )
                LEFT OUTER JOIN __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__gruposprodequiv   gp ON ( gp.codgrupoprod = ig.codgrupoprod )
            WHERE
                to_char(nvl(gp.codvisivelgrupo, p.codprod)) = to_char(l.codprod);
        
        
            /*m2*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm1, 0),
                nvl(ex.qtitensmanterm2, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom2, 0) - nvl(oa2.objetivooriginalm2, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom2, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom2, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom2, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom2 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m3*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm2, 0),
                nvl(ex.qtitensmanterm3, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom3, 0) - nvl(oa2.objetivooriginalm3, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom3, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom3, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom3, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom3 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m4*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm3, 0),
                nvl(ex.qtitensmanterm4, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom4, 0) - nvl(oa2.objetivooriginalm4, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom4, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom4, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom4, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom4 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m5*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm4, 0),
                nvl(ex.qtitensmanterm5, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom5, 0) - nvl(oa2.objetivooriginalm5, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom5, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom5, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom5, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom5 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m6*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm5, 0),
                nvl(ex.qtitensmanterm6, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom6, 0) - nvl(oa2.objetivooriginalm6, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom6, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom6, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom6, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom6 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m7*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm6, 0),
                nvl(ex.qtitensmanterm7, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom7, 0) - nvl(oa2.objetivooriginalm7, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom7, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom7, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom7, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom7 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m8*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm7, 0),
                nvl(ex.qtitensmanterm8, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom8, 0) - nvl(oa2.objetivooriginalm8, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom8, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom8, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom8, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom8 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m9*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm8, 0),
                nvl(ex.qtitensmanterm9, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom9, 0) - nvl(oa2.objetivooriginalm9, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom9, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom9, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom9, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom9 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m10*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm9, 0),
                nvl(ex.qtitensmanterm10, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom10, 0) - nvl(oa2.objetivooriginalm10, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom10, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom10, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom10, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom10 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m11*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm10, 0),
                nvl(ex.qtitensmanterm11, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom11, 0) - nvl(oa2.objetivooriginalm11, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom11, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom11, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom11, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom11 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;
            
            
            /*m12*/

            qtexcluirmesanterior := 0;
            qtitensmantermesatual := 0;
            SELECT
                nvl(ex.qtexcluirm11, 0),
                nvl(ex.qtitensmanterm12, 1)
            INTO
                qtexcluirmesanterior,
                qtitensmantermesatual
            FROM
                __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
            WHERE
                ex.codfilial = l.codfilial
                AND ex.codsupervisor = l.codsupervisor
                AND ex.codrca = l.codrca
                AND ex.codgrupogiro = l.codgrupogiro
                AND ex.ano = l.ano;

            IF nvl(qtexcluirmesanterior, 0) > 0 THEN
                SELECT
                    SUM(nvl(oa2.novoobjetivom12, 0) - nvl(oa2.objetivooriginalm12, 0))
                INTO qtjaincluidamesatual
                FROM
                    __FNV_GET_PREFIXOBJECTSDB__objetivosano oa2
                WHERE
                    oa2.codfilial = l.codfilial
                    AND oa2.codsupervisor = l.codsupervisor
                    AND oa2.codrca = l.codrca
                    AND oa2.codgrupogiro = l.codgrupogiro
                    AND oa2.ano = l.ano
                    AND nvl(oa2.novoobjetivom12, 0) > 0;

                IF nvl(qtjaincluidamesatual, 0) < nvl(qtexcluirmesanterior, 0) THEN
                    qtnovoobjet := nvl(l.novoobjetivom12, 0) + nvl(
                        CASE
                            WHEN nvl(l.novoobjetivom12, 0) > 0 THEN
                                nvl((nvl(qtexcluirmesanterior, 0) / nvl(qtitensmantermesatual, 1)), 0)
                            ELSE 0
                        END, 0);

                    qtnovoobjet := ceil((qtnovoobjet / peso1cx)) * peso1cx;
                    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano o
                    SET
                        o.novoobjetivom12 = qtnovoobjet
                    WHERE
                        o.codfilial = l.codfilial
                        AND o.codsupervisor = l.codsupervisor
                        AND o.codrca = l.codrca
                        AND o.codgrupogiro = l.codgrupogiro
                        AND o.codprod = l.codprod;

                    COMMIT;
                END IF;

            END IF;

        END IF;

    END LOOP;

    COMMIT;
END simularobjetivosano;",
        "codsituacaoregistro":1
	},
	"simularobjetivosano2":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"	
CREATE OR REPLACE PROCEDURE simularobjetivosano2 (
    p_limpar   BOOLEAN,
    p_ano      NUMBER
) AS
    v_mes         NUMBER DEFAULT 1;
    v_mes_texto   VARCHAR2(100) DEFAULT NULL;
    v_existe      NUMBER DEFAULT 0;
BEGIN
    IF p_limpar = true THEN
        DELETE FROM __FNV_GET_PREFIXOBJECTSDB__objetivosano;

        COMMIT;
    END IF;
    v_mes := 1;
    LOOP
        v_mes_texto := upper(trim(mes_texto(v_mes)));
        FOR l IN (
            SELECT
                u.codfilial,
                f.cidade         AS filial,
                u.codsupervisor,
                s.nome           AS nomesupervisor,
                o.codentidade    AS codrca,
                u.nome           AS nomerca,
                o.codgrupogiro,
                gg.nomegrupogiro,
                o.coditemvisao   AS codprod,
                nvl(g.nomegrupoprod, p.descricao) AS descricao,
                o.ano            AS ano,
                o.valor          AS objetivooriginal,
                o.realizado      AS realizado,
                (
                    SELECT
                        CASE v_mes
                            WHEN 1    THEN
                                SUM(nvl(mv.qtmovtotalgeralm1, 0))
                            WHEN 2    THEN
                                SUM(nvl(mv.qtmovtotalgeralm2, 0))
                            WHEN 3    THEN
                                SUM(nvl(mv.qtmovtotalgeralm3, 0))
                            WHEN 4    THEN
                                SUM(nvl(mv.qtmovtotalgeralm4, 0))
                            WHEN 5    THEN
                                SUM(nvl(mv.qtmovtotalgeralm5, 0))
                            WHEN 6    THEN
                                SUM(nvl(mv.qtmovtotalgeralm6, 0))
                            WHEN 7    THEN
                                SUM(nvl(mv.qtmovtotalgeralm7, 0))
                            WHEN 8    THEN
                                SUM(nvl(mv.qtmovtotalgeralm8, 0))
                            WHEN 9    THEN
                                SUM(nvl(mv.qtmovtotalgeralm9, 0))
                            WHEN 10   THEN
                                SUM(nvl(mv.qtmovtotalgeralm10, 0))
                            WHEN 11   THEN
                                SUM(nvl(mv.qtmovtotalgeralm11, 0))
                            WHEN 12   THEN
                                SUM(nvl(mv.qtmovtotalgeralm12, 0))
                            ELSE
                                NULL
                        END AS qtmovtotalgeral
                    FROM
                        __FNV_GET_PREFIXOBJECTSDB__ultentultsaidqts mv
                    WHERE
                        mv.codfilial = f.codigo
                        AND mv.ano = o.ano
                        AND to_char(
                            CASE
                                WHEN EXISTS(
                                    SELECT
                                        1
                                    FROM
                                        __FNV_GET_PREFIXOBJECTSDB__integgrupoprod itg1
                                    WHERE
                                        itg1.codprod = mv.codprod
                                ) THEN
                                    to_char((
                                        SELECT
                                            gp1.codvisivelgrupo
                                        FROM
                                            __FNV_GET_PREFIXOBJECTSDB__gruposprodequiv gp1
                                        WHERE
                                            gp1.codgrupoprod =(
                                                SELECT
                                                    itg1.codgrupoprod
                                                FROM
                                                    __FNV_GET_PREFIXOBJECTSDB__integgrupoprod itg1
                                                WHERE
                                                    itg1.codprod = mv.codprod
                                            )
                                    ))
                                ELSE
                                    to_char(mv.codprod)
                            END
                        ) = to_char(o.coditemvisao)
                ) AS qtmovtotalgeral
            FROM
                __FNV_GET_PREFIXOBJECTSDB__objetivossinergia          o
                LEFT OUTER JOIN jumbo.pcusuari                u ON ( u.codusur = o.codentidade )
                LEFT OUTER JOIN jumbo.pcfilial                f ON ( f.codigo = u.codfilial )
                LEFT OUTER JOIN jumbo.pcsuperv                s ON ( s.codsupervisor = u.codsupervisor )
                LEFT OUTER JOIN jumbo.pcprodut                p ON ( to_char(p.codprod) = o.coditemvisao )
                LEFT OUTER JOIN __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__gruposprodequiv   g ON ( g.codvisivelgrupo = o.coditemvisao )
                LEFT OUTER JOIN __FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__gruposgiro        gg ON ( gg.codgrupogiro = o.codgrupogiro )
            WHERE
                o.codcampanhasinergia = 0
                AND lower(TRIM(o.entidade)) = lower(TRIM('rca'))
                AND lower(TRIM(o.visao)) = lower(TRIM('produto'))
                AND lower(TRIM(o.unidade)) = lower(TRIM('kg'))
                AND o.ano = p_ano
                AND upper(TRIM(o.mes)) = v_mes_texto
            ORDER BY
                1,
                3,
                5,
                7,
                9
        ) LOOP
            v_existe := 0;
            SELECT
                COUNT(1)
            INTO v_existe
            FROM
                __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
            WHERE
                oa.codfilial = l.codfilial
                AND oa.codsupervisor = l.codsupervisor
                AND oa.codrca = l.codrca
                AND oa.codgrupogiro = l.codgrupogiro
                AND oa.codprod = l.codprod
                AND oa.ano = l.ano;

            IF v_existe = 0 THEN
                CASE v_mes
                    WHEN 1 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm1,
                            realizadom1,
                            qtmovm1
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 2 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm2,
                            realizadom2,
                            qtmovm2
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 3 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm3,
                            realizadom3,
                            qtmovm3
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 4 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm4,
                            realizadom4,
                            qtmovm4
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 5 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm5,
                            realizadom5,
                            qtmovm5
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 6 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm6,
                            realizadom6,
                            qtmovm6
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 7 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm7,
                            realizadom7,
                            qtmovm7
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 8 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm8,
                            realizadom8,
                            qtmovm8
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 9 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm9,
                            realizadom9,
                            qtmovm9
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 10 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm10,
                            realizadom10,
                            qtmovm10
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 11 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm11,
                            realizadom11,
                            qtmovm11
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    WHEN 12 THEN
                        INSERT INTO __FNV_GET_PREFIXOBJECTSDB__objetivosano (
                            codfilial,
                            filial,
                            codsupervisor,
                            nomesupervisor,
                            codrca,
                            nomerca,
                            codgrupogiro,
                            nomegrupogiro,
                            codprod,
                            descricao,
                            ano,
                            objetivooriginalm12,
                            realizadom12,
                            qtmovm12
                        ) VALUES (
                            l.codfilial,
                            l.filial,
                            l.codsupervisor,
                            l.nomesupervisor,
                            l.codrca,
                            l.nomerca,
                            l.codgrupogiro,
                            l.nomegrupogiro,
                            l.codprod,
                            l.descricao,
                            l.ano,
                            l.objetivooriginal,
                            l.realizado,
                            l.qtmovtotalgeral
                        );

                    ELSE
                        NULL;
                END CASE;
            ELSE
                CASE v_mes
                    WHEN 1 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm1 = l.objetivooriginal,
                            oa.realizadom1 = l.realizado,
                            oa.qtmovm1 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 2 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm2 = l.objetivooriginal,
                            oa.realizadom2 = l.realizado,
                            oa.qtmovm2 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 3 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm3 = l.objetivooriginal,
                            oa.realizadom3 = l.realizado,
                            oa.qtmovm3 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 4 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm4 = l.objetivooriginal,
                            oa.realizadom4 = l.realizado,
                            oa.qtmovm4 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 5 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm5 = l.objetivooriginal,
                            oa.realizadom5 = l.realizado,
                            oa.qtmovm5 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 6 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm6 = l.objetivooriginal,
                            oa.realizadom6 = l.realizado,
                            oa.qtmovm6 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 7 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm7 = l.objetivooriginal,
                            oa.realizadom7 = l.realizado,
                            oa.qtmovm7 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 8 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm8 = l.objetivooriginal,
                            oa.realizadom8 = l.realizado,
                            oa.qtmovm8 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 9 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm9 = l.objetivooriginal,
                            oa.realizadom9 = l.realizado,
                            oa.qtmovm9 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 10 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm10 = l.objetivooriginal,
                            oa.realizadom10 = l.realizado,
                            oa.qtmovm10 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 11 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm11 = l.objetivooriginal,
                            oa.realizadom11 = l.realizado,
                            oa.qtmovm11 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    WHEN 12 THEN
                        UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
                        SET
                            oa.objetivooriginalm12 = l.objetivooriginal,
                            oa.realizadom12 = l.realizado,
                            oa.qtmovm12 = l.qtmovtotalgeral
                        WHERE
                            oa.codfilial = l.codfilial
                            AND oa.codsupervisor = l.codsupervisor
                            AND oa.codrca = l.codrca
                            AND oa.codgrupogiro = l.codgrupogiro
                            AND oa.codprod = l.codprod
                            AND oa.ano = l.ano;

                    ELSE
                        NULL;
                END CASE;
            END IF;

        END LOOP;

        COMMIT;
        v_mes := v_mes + 1;
        EXIT WHEN v_mes > 12;
    END LOOP;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom1 =
            CASE
                WHEN nvl(oa.qtmovm1, 0) > 0 THEN
                    oa.objetivooriginalm1
                ELSE
                    0
            END,
        oa.novoobjetivom2 =
            CASE
                WHEN nvl(oa.qtmovm2, 0) > 0 THEN
                    oa.objetivooriginalm2
                ELSE
                    0
            END,
        oa.novoobjetivom3 =
            CASE
                WHEN nvl(oa.qtmovm3, 0) > 0 THEN
                    oa.objetivooriginalm3
                ELSE
                    0
            END,
        oa.novoobjetivom4 =
            CASE
                WHEN nvl(oa.qtmovm4, 0) > 0 THEN
                    oa.objetivooriginalm4
                ELSE
                    0
            END,
        oa.novoobjetivom5 =
            CASE
                WHEN nvl(oa.qtmovm5, 0) > 0 THEN
                    oa.objetivooriginalm5
                ELSE
                    0
            END,
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.qtmovm6, 0) > 0 THEN
                    oa.objetivooriginalm6
                ELSE
                    0
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.qtmovm7, 0) > 0 THEN
                    oa.objetivooriginalm7
                ELSE
                    0
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.qtmovm8, 0) > 0 THEN
                    oa.objetivooriginalm8
                ELSE
                    0
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.qtmovm9, 0) > 0 THEN
                    oa.objetivooriginalm9
                ELSE
                    0
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.qtmovm10, 0) > 0 THEN
                    oa.objetivooriginalm10
                ELSE
                    0
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.qtmovm11, 0) > 0 THEN
                    oa.objetivooriginalm11
                ELSE
                    0
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.qtmovm12, 0) > 0 THEN
                    oa.objetivooriginalm12
                ELSE
                    0
            END;

    COMMIT;
    DELETE FROM __FNV_GET_PREFIXOBJECTSDB__gruposexcluir;

    COMMIT;
    INSERT INTO __FNV_GET_PREFIXOBJECTSDB__gruposexcluir
        SELECT
            oa.codfilial,
            oa.codsupervisor,
            oa.codrca,
            oa.codgrupogiro,
            oa.ano,
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm1, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom1, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom1, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom1, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm1, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm2, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm2, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm3, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm3, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm4, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm4, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm5, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm5, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm6, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm6, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm7, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm7, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm8, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm8, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm9, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm9, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm10, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm10, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm11, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm11, 0)
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.objetivooriginalm12, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                        1
                    ELSE
                        NULL
                END
            ),
            COUNT(
                CASE
                    WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                        NULL
                    ELSE
                        1
                END
            ),
            SUM(
                CASE
                    WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                        0
                    ELSE
                        nvl(oa.objetivooriginalm12, 0)
                END
            )
        FROM
            __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
        GROUP BY
            oa.codfilial,
            oa.codsupervisor,
            oa.codrca,
            oa.codgrupogiro,
            oa.ano;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom2 =
            CASE
                WHEN nvl(oa.novoobjetivom2, 0) > 0 THEN
                    oa.novoobjetivom2 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm2, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom2
            END,
        oa.novoobjetivom3 =
            CASE
                WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                    oa.novoobjetivom3 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm3, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom3
            END,
        oa.novoobjetivom4 =
            CASE
                WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                    oa.novoobjetivom4 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm4, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom4
            END,
        oa.novoobjetivom5 =
            CASE
                WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                    oa.novoobjetivom5 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm5, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom5
            END,
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                    oa.novoobjetivom6 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm6, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom6
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                    oa.novoobjetivom7 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm7, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom7
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm8, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm9, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm10, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm2, 11)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm1, 0) / nvl(ex.qtitensmanterm12, 1)) / 11
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom3 =
            CASE
                WHEN nvl(oa.novoobjetivom3, 0) > 0 THEN
                    oa.novoobjetivom3 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm3, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom3
            END,
        oa.novoobjetivom4 =
            CASE
                WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                    oa.novoobjetivom4 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm4, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom4
            END,
        oa.novoobjetivom5 =
            CASE
                WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                    oa.novoobjetivom5 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm5, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom5
            END,
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                    oa.novoobjetivom6 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm6, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom6
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                    oa.novoobjetivom7 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm7, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom7
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm8, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm9, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm10, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm2, 11)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm2, 0) / nvl(ex.qtitensmanterm12, 1)) / 10
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom4 =
            CASE
                WHEN nvl(oa.novoobjetivom4, 0) > 0 THEN
                    oa.novoobjetivom4 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm4, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom4
            END,
        oa.novoobjetivom5 =
            CASE
                WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                    oa.novoobjetivom5 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm5, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom5
            END,
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                    oa.novoobjetivom6 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm6, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom6
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                    oa.novoobjetivom7 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm7, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom7
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm8, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm9, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm10, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm2, 11)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm3, 0) / nvl(ex.qtitensmanterm12, 1)) / 9
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom5 =
            CASE
                WHEN nvl(oa.novoobjetivom5, 0) > 0 THEN
                    oa.novoobjetivom5 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm5, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom5
            END,
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                    oa.novoobjetivom6 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm6, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom6
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                    oa.novoobjetivom7 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm7, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom7
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm8, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm9, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm10, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm2, 11)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm4, 0) / nvl(ex.qtitensmanterm12, 1)) / 8
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom6 =
            CASE
                WHEN nvl(oa.novoobjetivom6, 0) > 0 THEN
                    oa.novoobjetivom6 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm6, 1)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom6
            END,
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                    oa.novoobjetivom7 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm7, 1)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom7
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm8, 1)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm9, 1)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm10, 1)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm2, 11)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm5, 0) / nvl(ex.qtitensmanterm12, 1)) / 7
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom7 =
            CASE
                WHEN nvl(oa.novoobjetivom7, 0) > 0 THEN
                    oa.novoobjetivom7 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm6, 0) / nvl(ex.qtitensmanterm7, 1)) / 6
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom7
            END,
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm6, 0) / nvl(ex.qtitensmanterm8, 1)) / 6
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm6, 0) / nvl(ex.qtitensmanterm9, 1)) / 6
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm6, 0) / nvl(ex.qtitensmanterm10, 1)) / 6
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm6, 0) / nvl(ex.qtitensmanterm2, 11)) / 6
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm6, 0) / nvl(ex.qtitensmanterm12, 1)) / 6
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom8 =
            CASE
                WHEN nvl(oa.novoobjetivom8, 0) > 0 THEN
                    oa.novoobjetivom8 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm7, 0) / nvl(ex.qtitensmanterm8, 1)) / 5
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom8
            END,
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm7, 0) / nvl(ex.qtitensmanterm9, 1)) / 5
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm7, 0) / nvl(ex.qtitensmanterm10, 1)) / 5
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm7, 0) / nvl(ex.qtitensmanterm2, 11)) / 5
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm7, 0) / nvl(ex.qtitensmanterm12, 1)) / 5
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom9 =
            CASE
                WHEN nvl(oa.novoobjetivom9, 0) > 0 THEN
                    oa.novoobjetivom9 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm8, 0) / nvl(ex.qtitensmanterm9, 1)) / 4
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom9
            END,
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm8, 0) / nvl(ex.qtitensmanterm10, 1)) / 4
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm8, 0) / nvl(ex.qtitensmanterm2, 11)) / 4
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm8, 0) / nvl(ex.qtitensmanterm12, 1)) / 4
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom10 =
            CASE
                WHEN nvl(oa.novoobjetivom10, 0) > 0 THEN
                    oa.novoobjetivom10 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm9, 0) / nvl(ex.qtitensmanterm10, 1)) / 3
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom10
            END,
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm9, 0) / nvl(ex.qtitensmanterm2, 11)) / 3
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm9, 0) / nvl(ex.qtitensmanterm12, 1)) / 3
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom11 =
            CASE
                WHEN nvl(oa.novoobjetivom11, 0) > 0 THEN
                    oa.novoobjetivom11 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm10, 0) / nvl(ex.qtitensmanterm2, 11)) / 2
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom11
            END,
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm10, 0) / nvl(ex.qtitensmanterm12, 1)) / 2
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
    UPDATE __FNV_GET_PREFIXOBJECTSDB__objetivosano oa
    SET
        oa.novoobjetivom12 =
            CASE
                WHEN nvl(oa.novoobjetivom12, 0) > 0 THEN
                    oa.novoobjetivom12 + nvl((
                        SELECT
                            (nvl(ex.qtexcluirm11, 0) / nvl(ex.qtitensmanterm12, 1)) / 1
                        FROM
                            __FNV_GET_PREFIXOBJECTSDB__gruposexcluir ex
                        WHERE
                            ex.codfilial = oa.codfilial
                            AND ex.codsupervisor = oa.codsupervisor
                            AND ex.codrca = oa.codrca
                            AND ex.codgrupogiro = oa.codgrupogiro
                            AND ex.ano = oa.ano
                    ), 0)
                ELSE
                    oa.novoobjetivom12
            END;

    COMMIT;
END simularobjetivosano2;",
        "codsituacaoregistro":1
	},
	"estoque_por_entrada":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
CREATE OR REPLACE PROCEDURE estoque_por_entrada IS
    v_qtestatual   NUMBER DEFAULT 0;
    v_qtent        NUMBER DEFAULT 0;
BEGIN
    FOR lf IN (
        SELECT
            f.*
        FROM
            jumbo.pcfilial f
        WHERE
            f.codigo IN (
                1,
                2
            )
        ORDER BY
            f.codigo
    ) LOOP
        FOR le IN (
            SELECT
                e.*
            FROM
                jumbo.pcest e
            WHERE
                e.codfilial = lf.codigo
                AND greatest(nvl(e.qtestger, e.qtest), nvl(e.qtest, e.qtestger)) > 0
            ORDER BY
                e.codprod
        ) LOOP
            v_qtestatual := nvl(greatest(nvl(le.qtestger, le.qtest), nvl(le.qtest, le.qtestger)), 0);

            IF v_qtestatual > 0 THEN
                FOR lent IN (
                    SELECT
                        ne.dtent,
                        me.*
                    FROM
                        jumbo.pcnfent   ne
                        JOIN jumbo.pcmov     me ON ( me.numtransent = ne.numtransent )
                    WHERE
                        ne.codfilial = le.codfilial
                        AND me.codprod = le.codprod
                        AND me.codoper = 'E'
                        AND me.dtcancel IS NULL
                        AND ne.dtcancel IS NULL
                        AND nvl(me.qt, me.qtcont) - nvl(me.qtdevol, 0) > 0
                    ORDER BY
                        ne.dtent DESC
                ) LOOP
                    v_qtent := nvl(lent.qt, lent.qtcont) - nvl(lent.qtdevol, 0);

                    INSERT INTO __FNV_GET_PREFIXOBJECTSDB__entradas_estoque VALUES (
                        lent.dtent,
                        lent.numtransent,
                        lent.numnota,
                        lent.codfornec,
                        lent.codfilial,
                        lent.codprod,
                        lent.qt,
                        lent.punit,
                        v_qtestatual
                    );

                    COMMIT;
                    v_qtestatual := v_qtestatual - v_qtent;
                    EXIT WHEN v_qtestatual <= 0;
                END LOOP;

            END IF;

        END LOOP;
    END LOOP;
EXCEPTION
    WHEN OTHERS THEN
        dbms_output.put_line(sqlerrm);
        dbms_output.put_line(dbms_utility.format_error_backtrace);
        ROLLBACK;
END estoque_por_entrada;",
        "codsituacaoregistro":1
	},
	"analisar_entradas":{
		"codprocedimentosql":"__AUTOINC__",
		"nomeprocedimentosqldb":"__CHAVE__",
		"nomeprocsqlsistema":"__CHAVE__",
		"corpo":"
    create or replace procedure analisar_entradas(
        p_dtini date,
        p_dtfim date,
        p_divisao_datas number default 3)
    /*
        p_divisao_datas = [
            1 - semanal
            2 - quinzenal
            3 - mensal
            4 - bimestral
            5 - trimestral
            6 - quadrimestral
            7 - semestral
            8 - anual
            10 - estacoes
        ]
        estacoes = [
            outono = [20/03 - 19/06]
            inverno = [20/06 - 19/09]
            primavera = [20/09 - 19/12]
            verao = [20/12 - 19/03
        ]
    */
    as
        type tarr_data is varray(2) of date;
        type tarr_datas is table of tarr_data;
        type tarr_comandos is table of varchar2(32767);
        numdias number;
        arr_datas tarr_datas;
        v_dtini date;
        v_dtfim date;
        numdias_div number ;
        arr_comandos tarr_comandos;
        v_campos_anteriores varchar2(32767);
        v_campos_posteriores varchar2(32767);
        v_comando_sql1 varchar2(32767);
        v_comando_final clob default '';
        v_comando_sql varchar2(32767) default '    
    p__periodo__ as (
        SELECT
            m.codfilial,
            m.codprod,
            p.descricao,
            p.codepto,
            d.descricao as departamento,
            __campos_anteriores__
            sum(nvl(m.qt,m.qtcont)) as qt__periodo__,
            round(sum(nvl(m.qt,m.qtcont) * nvl(m.punit,m.punitcont)) / greatest(sum(nvl(m.qt,m.qtcont)),1),2) as \"__periodo__\"
            __campos_posteriores__
        FROM
            jumbo.pcmov m
            join jumbo.pcnfent e on (e.numtransent = m.numtransent)
            join jumbo.pcprodut p on (p.codprod = m.codprod)
            left outer join jumbo.pcdepto d on (d.codepto = p.codepto)
        where
            e.dtent between to_date(''__dtini__'',''dd/mm/yyyy'') and to_date(''__dtfim__'',''dd/mm/yyyy'')
            and e.dtcancel is null
            and e.coddevol is null
            and m.dtcancel is null
            and m.coddevol is null
            and m.codoper = ''E''
            and not exists (select 1 from jumbo.pcclient c where c.codcli = e.codfornec)
        group by
            m.codfilial,
            m.codprod,
            p.descricao,
            p.codepto,
            d.descricao
        having
            sum(nvl(m.qt,m.qtcont)) >= 100
    )';
        
        
        function ult_dia_semana(p_dt1 date) return date as
            v_retorno date;
        begin
            v_retorno := p_dt1;
            while(to_char(v_retorno,'D') <> '7') loop
                v_retorno := v_retorno +1;
            end loop;
            return v_retorno;
        end;
        
        function ult_dia_quinzena(p_dt1 date) return date as
            v_retorno date;
        begin
            v_retorno := p_dt1;
            if (to_char(v_retorno,'dd') > 15) then
                v_retorno := last_day(v_retorno);
            else
                v_retorno := to_date('15/' || to_char(v_retorno,'mm') || '/' || to_char(v_retorno,'yyyy'),'dd/mm/yyyy');
            end if;
            return v_retorno;
        end;
        
        function ult_dia_estacao(p_dt1 date) return date as
            v_retorno date;
        begin
            v_retorno := p_dt1;
            if v_retorno between to_date('20/03/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') and to_date('19/06/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') then
                v_retorno := to_date('19/06/' || to_char(v_retorno,'yyyy'),'dd/mm/yyyy');
            elsif v_retorno between to_date('20/06/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') and to_date('19/09/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') then
                v_retorno := to_date('19/09/' || to_char(v_retorno,'yyyy'),'dd/mm/yyyy');
            elsif v_retorno between to_date('20/09/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') and to_date('19/12/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') then
                v_retorno := to_date('19/12/' || to_char(v_retorno,'yyyy'),'dd/mm/yyyy');
            elsif v_retorno < to_date('19/03/'||to_char(v_retorno,'yyyy'),'dd/mm/yyyy') then
                v_retorno := to_date('19/03/' || to_char(v_retorno,'yyyy'),'dd/mm/yyyy');
            elsif v_retorno < to_date('19/03/'|| (to_char(v_retorno,'yyyy') + 1),'dd/mm/yyyy') then
                v_retorno := to_date('19/03/' || (to_char(v_retorno,'yyyy') + 1),'dd/mm/yyyy');
            end if;
            return v_retorno;
        end;
    begin
        numdias := (p_dtfim - p_dtini) + 1;
        arr_datas := tarr_datas();
        v_dtini := p_dtini;
        
        /*cria o array de periodos conforme parametros*/
        loop
            arr_datas.extend();
            arr_datas(arr_datas.last) := tarr_data();
            arr_datas(arr_datas.last).extend();
            arr_datas(arr_datas.last).extend();
            arr_datas(arr_datas.last)(1) := v_dtini;
            
            /*obtem a data final do periodo*/
            case p_divisao_datas 
                when 1 then arr_datas(arr_datas.last)(2) := ult_dia_semana(arr_datas(arr_datas.last)(1));
                when 2 then arr_datas(arr_datas.last)(2) := ult_dia_quinzena(arr_datas(arr_datas.last)(1));
                when 3 then arr_datas(arr_datas.last)(2) := last_day(arr_datas(arr_datas.last)(1));
                when 4 then arr_datas(arr_datas.last)(2) := last_day(add_months(arr_datas(arr_datas.last)(1),1));
                when 5 then arr_datas(arr_datas.last)(2) := last_day(add_months(arr_datas(arr_datas.last)(1),2));
                when 6 then arr_datas(arr_datas.last)(2) := last_day(add_months(arr_datas(arr_datas.last)(1),3));
                when 7 then arr_datas(arr_datas.last)(2) := last_day(add_months(arr_datas(arr_datas.last)(1),5));
                when 8 then arr_datas(arr_datas.last)(2) := last_day(add_months(arr_datas(arr_datas.last)(1),11));
                when 10 then arr_datas(arr_datas.last)(2) := ult_dia_estacao(arr_datas(arr_datas.last)(1));
                else arr_datas(arr_datas.last)(2) := last_day(arr_datas(arr_datas.last)(1));
            end case;
            v_dtini := arr_datas(arr_datas.last)(2) + 1;
            --dbms_output.put_line('periodo ' || arr_datas(arr_datas.last)(1) || '-' || arr_datas(arr_datas.last)(2));
            exit when arr_datas(arr_datas.last)(2) >= p_dtfim;
        end loop;
        
        arr_comandos := tarr_comandos();
        for i in arr_datas.first..arr_datas.last loop
            v_comando_sql1 := v_comando_sql;
            
            /*inclui os campos de periodos anteriores ao atual*/
            v_campos_anteriores := '';
            for j in arr_datas.first .. i -1  loop
                v_campos_anteriores := v_campos_anteriores 
                    || '0 as qt' || to_char(arr_datas(j)(1),'ddmmyyyy') || '_' || to_char(arr_datas(j)(2),'ddmmyyyy') || ','
                    || '0 as \"' || to_char(arr_datas(j)(1),'ddmmyyyy') || '_' || to_char(arr_datas(j)(2),'ddmmyyyy') || '\",';
            end loop;        
            v_comando_sql1 := replace(v_comando_sql1,'__campos_anteriores__',v_campos_anteriores);        
            
            /*trata o comando sql atual*/
            v_comando_sql1 := replace(v_comando_sql1,'__periodo__',to_char(arr_datas(i)(1),'ddmmyyyy') || '_' || to_char(arr_datas(i)(2),'ddmmyyyy'));
            v_comando_sql1 := replace(v_comando_sql1,'__dtini__',to_char(arr_datas(i)(1),'dd/mm/yyyy'));
            v_comando_sql1 := replace(v_comando_sql1,'__dtfim__',to_char(arr_datas(i)(2),'dd/mm/yyyy'));
            
            /*inclui os campos de periodos posteriores ao atual*/
            v_campos_posteriores := '';
            for k in i+1 .. arr_datas.last loop
                v_campos_posteriores := v_campos_posteriores || ',' 
                    || '0 as qt' || to_char(arr_datas(k)(1),'ddmmyyyy') || '_' || to_char(arr_datas(k)(2),'ddmmyyyy') || ','
                    || '0 as \"' || to_char(arr_datas(k)(1),'ddmmyyyy') || '_' || to_char(arr_datas(k)(2),'ddmmyyyy') || '\"';
            end loop;
            if (length(v_campos_posteriores) > 0) then
                v_comando_sql1 := replace(v_comando_sql1,'__campos_posteriores__',v_campos_posteriores);
            else 
                v_comando_sql1 := replace(v_comando_sql1,'__campos_posteriores__','');
            end if;
            --dbms_output.put_line(v_comando_sql1); return;
            arr_comandos.extend();
            arr_comandos(arr_comandos.last) := v_comando_sql1;
        end loop;
        
        v_comando_final := 'with ';
        for i in arr_comandos.first..arr_comandos.last loop
            v_comando_final := v_comando_final || arr_comandos(i) || ',';
        end loop;
        v_comando_final := v_comando_final || 'resultante1 as (';
        for i in arr_datas.first..arr_datas.last loop
            v_comando_final := v_comando_final || 'select * from p'||to_char(arr_datas(i)(1),'ddmmyyyy') || '_' || to_char(arr_datas(i)(2),'ddmmyyyy');
            if i < arr_datas.last then
                v_comando_final := v_comando_final || ' union all ';
            end if;
        end loop;
        v_comando_final := v_comando_final || '), resultante2 as ( select codfilial,codprod,descricao,codepto,departamento';
        for i in arr_datas.first..arr_datas.last loop
            v_comando_final := v_comando_final 
                || ',sum(nvl(qt' ||to_char(arr_datas(i)(1),'ddmmyyyy') || '_' || to_char(arr_datas(i)(2),'ddmmyyyy')||',0)) as qt'||to_char(arr_datas(i)(1),'ddmmyyyy') || '_' || to_char(arr_datas(i)(2),'ddmmyyyy')
                || ',sum(nvl(\"' ||to_char(arr_datas(i)(1),'ddmmyyyy') || '_' || to_char(arr_datas(i)(2),'ddmmyyyy')||'\",0)) as \"'||to_char(arr_datas(i)(1),'ddmmyyyy') || '_' || to_char(arr_datas(i)(2),'ddmmyyyy') || '\"' ;
        end loop;
        v_comando_final := v_comando_final || ' from resultante1 group by codfilial,codprod,descricao,codepto,departamento) select * from resultante2';
        --dbms_output.put_line(v_comando_final);
        --__FNV_GET_NOMESCHEMA__.__FNV_GET_PREFIXOBJECTSDB__pkg_funcs_arquivo.criar_arquivo_xlsx(v_comando_final,'DIR_VENDAS_AUR','teste.xlsx');
    exception    
        when others then
            dbms_output.put_line(sqlerrm);
            dbms_output.put_line(dbms_utility.format_error_backtrace);
            dbms_output.put_line(dbms_utility.format_call_stack);
            dbms_output.put_line(dbms_utility.format_error_stack);
    end analisar_entradas;",
        "codsituacaoregistro":1
	}		
}